(* ::Package:: *)

LaunchKernels[1];


(* ::Section::Initialization::Closed:: *)
(*(*Conformal block functions*)*)


(* ::Input::Initialization:: *)
\[ScriptCapitalF][n_,m_,l_,\[CapitalDelta]_,\[CapitalDelta]12_,\[CapitalDelta]34_,z_]:=(z Conjugate[z])^((\[CapitalDelta]-l)/2)/(z-Conjugate[z])^3 ((-(z/2))^l z^(n+3) Conjugate[z]^m Hypergeometric2F1[(\[CapitalDelta]+l-\[CapitalDelta]12)/2+n,(\[CapitalDelta]+l+\[CapitalDelta]34)/2+n,\[CapitalDelta]+l+2n,z]Hypergeometric2F1[(\[CapitalDelta]-l-\[CapitalDelta]12)/2-3+m,(\[CapitalDelta]-l+\[CapitalDelta]34)/2-3+m,\[CapitalDelta]-l-6+2m,Conjugate[z]]-(-(Conjugate[z]/2))^l Conjugate[z]^(n+3) z^m Hypergeometric2F1[(\[CapitalDelta]+l-\[CapitalDelta]12)/2+n,(\[CapitalDelta]+l+\[CapitalDelta]34)/2+n,\[CapitalDelta]+l+2n,Conjugate[z]]Hypergeometric2F1[(\[CapitalDelta]-l-\[CapitalDelta]12)/2-3+m,(\[CapitalDelta]-l+\[CapitalDelta]34)/2-3+m,\[CapitalDelta]-l-6+2m,z])


(* ::Input::Initialization:: *)
\[ScriptCapitalG][l_,\[CapitalDelta]_,\[CapitalDelta]12_,\[CapitalDelta]34_,z_]:=\[ScriptCapitalF][0,0,l,\[CapitalDelta],\[CapitalDelta]12,\[CapitalDelta]34,z]-(l+3)/(l+1) \[ScriptCapitalF][-1,1,l,\[CapitalDelta],\[CapitalDelta]12,\[CapitalDelta]34,z]+((\[CapitalDelta]-4)(l+3))/(16(\[CapitalDelta]-2)(l+1)) ((\[CapitalDelta]-l-\[CapitalDelta]12-4)(\[CapitalDelta]-l+\[CapitalDelta]12-4)(\[CapitalDelta]-l+\[CapitalDelta]34-4)(\[CapitalDelta]-l-\[CapitalDelta]34-4))/((\[CapitalDelta]-l-5)(\[CapitalDelta]-l-4)^2 (\[CapitalDelta]-l-3)) \[ScriptCapitalF][0,2,l,\[CapitalDelta],\[CapitalDelta]12,\[CapitalDelta]34,z]-(\[CapitalDelta]-4)/(\[CapitalDelta]-2) ((\[CapitalDelta]+l-\[CapitalDelta]12)(\[CapitalDelta]+l+\[CapitalDelta]12)(\[CapitalDelta]+l+\[CapitalDelta]34)(\[CapitalDelta]+l-\[CapitalDelta]34))/(16(\[CapitalDelta]+l-1)(\[CapitalDelta]+l)^2 (\[CapitalDelta]+l+1)) \[ScriptCapitalF][1,1,l,\[CapitalDelta],\[CapitalDelta]12,\[CapitalDelta]34,z]+(2(\[CapitalDelta]-4)(l+3)\[CapitalDelta]12 \[CapitalDelta]34)/((\[CapitalDelta]+l)(\[CapitalDelta]+l-2)(\[CapitalDelta]+l-4)(\[CapitalDelta]+l-6)) \[ScriptCapitalF][0,1,l,\[CapitalDelta],\[CapitalDelta]12,\[CapitalDelta]34,z]


(* ::Input::Initialization:: *)
aat[\[CapitalDelta]_,l_,z_]:=4/(z^6 Conjugate[z]^6 (\[CapitalDelta]-l-2)(\[CapitalDelta]+l+2)) \[ScriptCapitalG][l,\[CapitalDelta]+4,0,-2,z]//Simplify


(* ::Section::Initialization::Closed:: *)
(*(*z sample*)*)


zre = {0.5414285714285715, 0.6357142857142857, 0.5728571428571428,
                             0.5257142857142857, 0.51, 0.5571428571428572, 0.73,
                             0.5257142857142857, 0.6985714285714286, 0.5257142857142857,
                             0.6514285714285715, 0.6828571428571428, 0.62, 0.6828571428571428,
                             0.6042857142857143, 0.7142857142857143, 0.6671428571428571,
                             0.6357142857142857, 0.6514285714285715, 0.5885714285714285,
                             0.5728571428571428, 0.6357142857142857, 0.5571428571428572,
                             0.5728571428571428, 0.5414285714285715, 0.5728571428571428, 0.62,
                             0.62, 0.5257142857142857, 0.5885714285714285, 0.62,
                             0.6514285714285715, 0.5571428571428572, 0.5728571428571428,
                             0.5414285714285715, 0.6828571428571428, 0.6357142857142857, 0.62,
                             0.6985714285714286, 0.5728571428571428, 0.5885714285714285, 0.51,
                             0.6985714285714286, 0.6514285714285715, 0.5885714285714285,
                             0.5728571428571428, 0.5885714285714285, 0.5414285714285715,
                             0.5257142857142857, 0.62, 0.6042857142857143, 0.6042857142857143,
                             0.6985714285714286, 0.5571428571428572, 0.6357142857142857,
                             0.5414285714285715, 0.73, 0.5257142857142857, 0.6514285714285715,
                             0.51, 0.62, 0.5885714285714285, 0.5414285714285715,
                             0.7142857142857143, 0.6357142857142857, 0.7142857142857143, 0.51,
                             0.51, 0.5885714285714285, 0.5414285714285715, 0.62,
                             0.6985714285714286, 0.6042857142857143, 0.6514285714285715,
                             0.5885714285714285, 0.6828571428571428, 0.73, 0.6671428571428571,
                             0.5728571428571428, 0.6828571428571428, 0.62, 0.5257142857142857,
                             0.5257142857142857, 0.5571428571428572, 0.5414285714285715,
                             0.6357142857142857, 0.5257142857142857, 0.62, 0.51,
                             0.6671428571428571, 0.6671428571428571, 0.5885714285714285,
                             0.6671428571428571, 0.6671428571428571, 0.5414285714285715,
                             0.6828571428571428, 0.5885714285714285, 0.51, 0.5414285714285715,
                             0.6671428571428571, 0.5728571428571428, 0.6671428571428571,
                             0.5257142857142857, 0.6042857142857143, 0.5257142857142857,
                             0.5728571428571428, 0.73, 0.5885714285714285, 0.6357142857142857,
                             0.51, 0.51, 0.6042857142857143, 0.73, 0.7142857142857143,
                             0.5257142857142857, 0.5571428571428572, 0.62, 0.5571428571428572,
                             0.5728571428571428, 0.5571428571428572, 0.6042857142857143,
                             0.7142857142857143, 0.6514285714285715, 0.6514285714285715,
                             0.5885714285714285, 0.51, 0.51, 0.6042857142857143,
                             0.6042857142857143, 0.6828571428571428, 0.51, 0.5257142857142857,
                             0.5571428571428572, 0.73, 0.7142857142857143, 0.6042857142857143,
                             0.5257142857142857, 0.73, 0.6985714285714286, 0.6828571428571428,
                             0.6671428571428571, 0.6514285714285715, 0.6357142857142857, 0.73,
                             0.5571428571428572, 0.5885714285714285, 0.7142857142857143,
                             0.6514285714285715, 0.5414285714285715, 0.5571428571428572,
                             0.5414285714285715, 0.5571428571428572, 0.5414285714285715,
                             0.5571428571428572, 0.6357142857142857, 0.5257142857142857, 0.51,
                             0.5414285714285715, 0.51, 0.6985714285714286, 0.5571428571428572,
                             0.6357142857142857, 0.6357142857142857, 0.62, 0.6514285714285715,
                             0.5728571428571428, 0.51, 0.5414285714285715, 0.7142857142857143,
                             0.6042857142857143, 0.6042857142857143, 0.5728571428571428,
                             0.6985714285714286, 0.5728571428571428, 0.6828571428571428,
                             0.6042857142857143, 0.62, 0.5728571428571428, 0.5571428571428572,
                             0.6514285714285715};
zim = {0.6071428571428571, 0.4414285714285714, 0.4414285714285714,
                             0.23428571428571426, 0.39999999999999997, 0.11, 0.2757142857142857,
                             0.6071428571428571, 0.5657142857142857, 0.69, 0.5657142857142857,
                             0.5657142857142857, 0.23428571428571426, 0.4828571428571428,
                             0.3171428571428571, 0.39999999999999997, 0.3171428571428571,
                             0.1514285714285714, 0.4414285714285714, 0.4414285714285714,
                             0.19285714285714284, 0.39999999999999997, 0.5657142857142857,
                             0.5657142857142857, 0.4828571428571428, 0.11, 0.5657142857142857,
                             0.3171428571428571, 0.19285714285714284, 0.19285714285714284,
                             0.4828571428571428, 0.35857142857142854, 0.35857142857142854,
                             0.4828571428571428, 0.11, 0.39999999999999997, 0.6071428571428571,
                             0.5242857142857142, 0.4828571428571428, 0.5242857142857142,
                             0.23428571428571426, 0.6071428571428571, 0.4414285714285714,
                             0.2757142857142857, 0.39999999999999997, 0.3171428571428571,
                             0.5657142857142857, 0.6485714285714285, 0.1514285714285714,
                             0.4414285714285714, 0.39999999999999997, 0.5242857142857142,
                             0.23428571428571426, 0.39999999999999997, 0.3171428571428571,
                             0.5657142857142857, 0.35857142857142854, 0.5657142857142857,
                             0.19285714285714284, 0.6485714285714285, 0.39999999999999997,
                             0.4828571428571428, 0.4414285714285714, 0.35857142857142854,
                             0.5242857142857142, 0.3171428571428571, 0.1514285714285714,
                             0.5242857142857142, 0.5242857142857142, 0.1514285714285714,
                             0.19285714285714284, 0.35857142857142854, 0.6485714285714285,
                             0.4828571428571428, 0.1514285714285714, 0.23428571428571426,
                             0.39999999999999997, 0.4414285714285714, 0.6485714285714285,
                             0.4414285714285714, 0.6485714285714285, 0.11, 0.2757142857142857,
                             0.2757142857142857, 0.39999999999999997, 0.19285714285714284,
                             0.5242857142857142, 0.1514285714285714, 0.4414285714285714,
                             0.2757142857142857, 0.5657142857142857, 0.3171428571428571,
                             0.23428571428571426, 0.5242857142857142, 0.19285714285714284,
                             0.3171428571428571, 0.6071428571428571, 0.23428571428571426,
                             0.3171428571428571, 0.39999999999999997, 0.35857142857142854,
                             0.35857142857142854, 0.4828571428571428, 0.35857142857142854,
                             0.6485714285714285, 0.23428571428571426, 0.4414285714285714,
                             0.6485714285714285, 0.2757142857142857, 0.11, 0.69,
                             0.2757142857142857, 0.23428571428571426, 0.11, 0.4414285714285714,
                             0.6485714285714285, 0.6071428571428571, 0.6071428571428571,
                             0.39999999999999997, 0.69, 0.4828571428571428, 0.4828571428571428,
                             0.23428571428571426, 0.3171428571428571, 0.35857142857142854,
                             0.5657142857142857, 0.19285714285714284, 0.4414285714285714,
                             0.6071428571428571, 0.2757142857142857, 0.35857142857142854,
                             0.39999999999999997, 0.3171428571428571, 0.3171428571428571,
                             0.2757142857142857, 0.5657142857142857, 0.3171428571428571,
                             0.5242857142857142, 0.39999999999999997, 0.5242857142857142,
                             0.4828571428571428, 0.5242857142857142, 0.4828571428571428,
                             0.4828571428571428, 0.4828571428571428, 0.2757142857142857,
                             0.4414285714285714, 0.6071428571428571, 0.5242857142857142,
                             0.23428571428571426, 0.23428571428571426, 0.1514285714285714, 0.69,
                             0.5242857142857142, 0.5657142857142857, 0.35857142857142854,
                             0.2757142857142857, 0.35857142857142854, 0.4828571428571428,
                             0.3171428571428571, 0.19285714285714284, 0.35857142857142854,
                             0.23428571428571426, 0.2757142857142857, 0.39999999999999997,
                             0.1514285714285714, 0.3171428571428571, 0.2757142857142857,
                             0.5242857142857142, 0.19285714285714284, 0.1514285714285714, 0.69,
                             0.5242857142857142, 0.2757142857142857, 0.35857142857142854,
                             0.23428571428571426, 0.35857142857142854, 0.6071428571428571,
                             0.4414285714285714, 0.1514285714285714};


zsamp = SetPrecision[zre + I * zim,16];


(* ::Section::Initialization:: *)
(*(*Create list and csv file*)*)


arraynum = Round[ToExpression[Environment["SGE_TASK_ID"]]] 
(*Apocrita array number, starting from 1*)


(* ::Input::Initialization:: *)
spin=0;
floor=-0.2 +(6+spin)+(arraynum-1); (*conformal weight starting value*)
step = 0.0005; (* inverse is 2000 *)
ceiling=1+floor-step;(*conformal weight end value*)


fname = StringJoin["/mathematica/6d_blocks_spin", ToString[spin],"_",ToString[arraynum],".csv"];


(* ::Input::Initialization:: *)
output={};


(* ::Input::Initialization:: *)
(* 1999 = 1 / 0.0005 - 1 *)
For[i=0,i<=1999,i+=1,AppendTo[output,SetPrecision[Re[# Conjugate[#]aat[floor+i*step,spin,#]-(1-#) Conjugate[1-#]aat[floor+i*step,spin,1-#]]&/@zsamp,16]]; Print["Evaluating Delta = ", floor+i*step]]


fpath = StringJoin[Directory[],fname];


(* ::Input::Initialization:: *)
Export[fpath,output//Flatten]
